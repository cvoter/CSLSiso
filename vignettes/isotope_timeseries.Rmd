---
title: "Isotope Interpretations"
output: 
  rmarkdown::html_vignette:
    toc: true
vignette: >
  %\VignetteIndexEntry{Put the title of your vignette here}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(devtools)
library(isoH2Obudget)
library(dplyr) #for pipes, filtering, and selecting
library(reshape2) #for melting
library(ggplot2) #for plotting
library(extrafont) #for fonts
library(knitr)
```

```{r isotopes, eval=TRUE, echo=FALSE}
data(isotopes)
psnt_isotopes <- isotopes %>% 
                 filter(lake == "Pleasant" | site_id == "PRECIP")
ll_isotopes   <- isotopes %>% 
                 filter(lake == "Long" | site_id == "PRECIP")
pfl_isotopes  <- isotopes %>% 
                 filter(lake == "Plainfield" | site_id == "PRECIP")
```

## Updates
Updates since last dicussion include:

* **Redefined static upgradient wells** for use in static approach to
classifying upgradient vs. downgradients wells based on which wells are most
consistently upgradient over the current timeseries.

## Overview
When looking at these plots, keep in mind that measurements closest to the
meteoric water line are most likely inflowing groundwater wells while
measurements drifting off to the right are likely outflowing groundwater wells
(or the lake itself), which are influenced by evaporation.

```{r schematic, out.width = "75%", eval=TRUE, echo=FALSE, fig.align="center"}
include_graphics(system.file("images", 
                             "isotope_signatures.png", 
                             package = "isoH2Obudget", 
                             mustWork = TRUE))
```

## Pleasant Lake
The original classifications for each well (as noted by Justin P.) were:

| Upgradient | Downgradient |
|:-----------|:-------------|
|PSNT-01     |PSNT-03       |
|PSNT-07     |PSNT-05       |
|PSNT-08     |PSNT-06       |
|PSNT-09     |PSNT-10       |
|PSNT-14     |PSNT-11       |
|PSNT-15     |              |
|PSNT-16     |              |

For the current approach to static well classification, only **PSNT-01** and
**PSNT-16** are used for upgradient measurements.

Aaron mentioned at an earlier meeting that PSNT-11 and PSNT-06 may have well
construction issues which cause them to respond very strongly to precipitation
events.

```{r psnt_facet, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=7, fig.height=6, fig.align="center"}
psnt_facet <- ggplot(data = psnt_isotopes,
                    aes(x = d18O, y = d2H, group = site_id))
psnt_facet <- plot_facet(psnt_facet, df = psnt_isotopes)
psnt_facet
```

<br>
```{r psnt_level, out.width = "90%", eval=TRUE, echo=FALSE, fig.align="center"}
include_graphics(system.file("images", 
                             "pleasant_lake_water_levels.png", 
                             package = "isoH2Obudget", 
                             mustWork = TRUE))
```

<br>
For completeness, here are all sites on the same plot.

```{r psnt_colors, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=4, fig.align="center"}
psnt_colors <- ggplot(data = psnt_isotopes,
                      aes(x = d18O, y = d2H, group = site_id))
psnt_colors <- plot_colors(psnt_colors)
psnt_colors
```

## Long Lake
The original classifications for each well (as noted by Justin P.) were:

| Upgradient | Downgradient |
|:-----------|:-------------|
|LL-01       |LL-02         |
|LL-06       |LL-03         |
|LL-07       |LL-04         |
|LL-08       |LL-05         |
|            |LL-09         |
|            |LL-10         |

For the current approach to static well classification, only **LL-06** and
**LL-07** are used for upgradient measurements.

```{r ll_facet, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=7, fig.height=6, fig.align="center"}
ll_facet <- ggplot(data = ll_isotopes,
                    aes(x = d18O, y = d2H, group = site_id))
ll_facet <- plot_facet(ll_facet, df = ll_isotopes)
ll_facet
```
<br>
```{r ll_pfl_level, out.width = "90%", eval=TRUE, echo=FALSE, fig.align="center"}
include_graphics(system.file("images", 
                             "long_plainfield_lake_water_levels.png", 
                             package = "isoH2Obudget", 
                             mustWork = TRUE))
```
<br>
For completeness, here are all sites on the same plot.

```{r ll_colors, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=4, fig.align="center"}
ll_colors <- ggplot(data = ll_isotopes,
                      aes(x = d18O, y = d2H, group = site_id))
ll_colors <- plot_colors(ll_colors)
ll_colors
```


## Plainfield Lake
The original classifications for each well (as noted by Justin P.) were:

| Upgradient | Downgradient |
|:-----------|:-------------|
|PFL-02      |PFL-03        |
|PFL-04      |PFL-05        |
|PFL-11      |PFL-07        |
|PFL-13      |PFL-09        |
|PFL-14      |              |

For the current approach to static well classification, only **PFL-02** and
**PFL-05** are used for upgradient measurements.

```{r pfl_facet, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=7, fig.height=6, fig.align="center"}
pfl_facet <- ggplot(data = pfl_isotopes,
                    aes(x = d18O, y = d2H, group = site_id))
pfl_facet <- plot_facet(pfl_facet, df = pfl_isotopes)
pfl_facet
```
<br>
For completeness, here are all sites on the same plot.

```{r pfl_colors, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=4, fig.align="center"}
pfl_colors <- ggplot(data = pfl_isotopes,
                      aes(x = d18O, y = d2H, group = site_id))
pfl_colors <- plot_colors(pfl_colors)
pfl_colors
```

## Session Info

The version of R and the versions of packages in use when this R Markdown file
was created are listed here:

```{r session_info, include=TRUE, echo=TRUE, results='markup'}
devtools::session_info()
```
