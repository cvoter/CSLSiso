<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>CSLS Isotope Water Budget</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">CSLS Isotope Water Budget</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(devtools)</a></code></pre></div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This water budget model uses stable isotope measurements of precipitation, evaporation, lake water, and inflowing groundwater as well as observed precipitation and evaporation rates to calculate monthly groundwater flow into and out of a lake.</p>
<p><br></p>
<p><strong>Groundwater inflow</strong> is calculated as follows (Krabbenhoft et al., 1990):</p>
<p><span class="math display">\[\begin{align}
\tag{1}
GW_{in} = \frac{P*(\delta^{18}O_{L} - \delta^{18}O_{P}) + E*(\delta^{18}O_{E} - \delta^{18}O_{L})}{\delta^{18}O_{GW_{in}} - \delta^{18}O_{L}}
\end{align}\]</span></p>
<p>where <span class="math inline">\(GW_{in}\)</span> is the groundwater inflow [L^3/T], <span class="math inline">\(P\)</span> is precipitation [L^3/T], <span class="math inline">\(E\)</span> is evaporation [L^3/T], and <span class="math inline">\(\delta^{18}O_{x}\)</span> is the relative isotopic composition in units of per mil relative to a known standard. The relative isotopic composition is defined as <span class="math inline">\(\delta^{18}O_{x} = [\frac{R_{x}}{R_{std}} - 1] * 10^{3}\)</span> where <span class="math inline">\(R_{x}\)</span> is the ratio of isotope concentrations (e.g., <span class="math inline">\(\frac{^{18}O}{^{16}O}\)</span>). <span class="math inline">\(\delta^{18}O_{L}\)</span> is measured at the lake, <span class="math inline">\(\delta^{18}O_{P}\)</span> is measured from precipitation, <span class="math inline">\(\delta^{18}O_{E}\)</span> is estimated for evaporation, and <span class="math inline">\(\delta^{18}O_{GW_{in}}\)</span> is measured at inflowing groundwater wells.</p>
<p><br></p>
<p><strong>Groundwater outflow</strong> can then be calculated from the following equation (Krabbenhoft et al., 1990):</p>
<p><span class="math display">\[\begin{align}
\tag{2}
\frac{dV}{dt} = 0 = GW_{in} + P - GW_{out} - E
\end{align}\]</span></p>
<p>where <span class="math inline">\(\frac{dV}{dt}\)</span> is the change in lake volume [L^3/T] and <span class="math inline">\(GW_{out}\)</span> is the groundwater outflow [L^3/T]. If changes in lake volume are measured (i.e., <span class="math inline">\(\frac{dV}{dt} \neq 0\)</span>), then these changes are substituted for 0 and the modeled groundwater outflows are adjusted.</p>
<p><br></p>
<p><span class="math inline">\(\delta^{18}O_{E}\)</span> <strong>must be estimated</strong> as follows (Krabbenhoft et al., 1990) since it cannot be directly measured like <span class="math inline">\(\delta^{18}O_{P}\)</span>, <span class="math inline">\(\delta^{18}O_{L}\)</span>, or <span class="math inline">\(\delta^{18}O_{GW_{in}}\)</span>.</p>
<p><span class="math display">\[\begin{align}
\tag{3}
\delta^{18}O_{E} = \frac{\alpha * \delta^{18}O_{L} - h*\delta^{18}O_{A} - \epsilon}{1 - h +10^{-3}\Delta \epsilon}
\end{align}\]</span></p>
<p>The terms of Eq. 3 are calculated using the following definitions (Krabbenhoft et al., 1990; Ozaydin et al., 2001):</p>
<p><span class="math display">\[\begin{align}
\tag{4}
\alpha &amp;= \frac{-2.0667 - \frac{415.6}{t} + (\frac{1137}{t^2})*10^3}{1000} \\
\tag{5}
h &amp;= RH*\frac{es_{A}}{es_{L}} \\
\tag{6}
es &amp;= \frac{1321.7e^{\frac{17.27t}{237}+t}}{273+t} \\
\tag{7}
\delta^{18}O_{A} &amp;= \frac{\delta^{18}O_{P}}{\alpha} - (1 - \frac{1}{\alpha}) \\
\tag{8}
\epsilon &amp;= 1000(1 - \alpha) + \Delta \epsilon \\
\tag{9}
\Delta \epsilon &amp;= 14.3*(1 - h)
\end{align}\]</span></p>
<p>where <span class="math inline">\(t\)</span> is air temperature (K) for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(es_{A}\)</span>, <span class="math inline">\(t\)</span> is lake temperature (K) for <span class="math inline">\(es_{L}\)</span>, and <span class="math inline">\(RH\)</span> is relative humidity.</p>
</div>
<div id="data-sources" class="section level2">
<h2>Data Sources</h2>
<p>Input data for the Central Sands Lake Study sites (Pleasant Lake, Long Lake, and Plainfield Lake) are located in the “data” folder of this project. Required inputs include:</p>
<ul>
<li>Monthly mean air temperature (K)</li>
<li>Monthly mean relative humidity (%)</li>
<li>Monthly precipitation depth (mm)</li>
<li>Monthly reference potential evapotranspiration depths (mm)</li>
<li>Monthly mean lake surface temperature (K)</li>
<li>Regular (e.g., monthly or every-other-month) stable isotope measurements of <span class="math inline">\(\delta^{18}O_{L}\)</span>, <span class="math inline">\(\delta^{18}O_{GW_{in}}\)</span>, and <span class="math inline">\(\delta^{18}O_{P}\)</span></li>
</ul>
<div id="meteorological-data" class="section level3">
<h3>1. Meteorological Data</h3>
<p>For the Central Sands Lake Study, daily air temperature, relative humidity, precipitation, and reference potential evapotranspiration are downloaded from the <a href="https://enviroweather.msu.edu/weather.php?stn=hck">Hancock Agricultural Research Station website</a> (station id: hck). This weather station is located in Hancock, WI (location: 44.1188, -89.533, elevation: 241m), approximately 8 miles from Plainfield Lake, 8.5 miles from Long Lake, and 14.5 miles from Pleasant Lake.</p>
<p>On the Hancock Station website, click on “Weather Station at Hancock” or “More weather for this station” to be routed to a page with options for “Custom Reports (Data-on-Demand)”. Select Data Type “Daily Data”, then check Max Air Temperature [1.5m], Min Air Temperature [1.5m], Precipitaiton, Max Relative Humidity [1.5m], Min Relative Humidity [1.5m], and reference potential evapotranspiration. Select starting date and end date, display units (metric), and output (csv), then “Generate Report”. Note that the earliest starting date allowed (as of January and September 2019) is February 15, 2018.</p>
</div>
<div id="lake-temperature-data" class="section level3">
<h3>2. Lake Temperature Data</h3>
<p>Lake surface temperatures are extracted from the surface depth of a vertical lake temperature profile that was collected every other week at each lake. This data is stored in SWIMS.</p>
</div>
<div id="stable-isotope-measurements" class="section level3">
<h3>3. Stable Isotope Measurements</h3>
<p>Measurements of <span class="math inline">\(\delta^{18}O_{L}\)</span> and <span class="math inline">\(\delta^{18}O_{GW_{in}}\)</span> are collected on site for each lake while <span class="math inline">\(\delta^{18}O_{P}\)</span> is measured using samples collected at the Hancock Research Station.</p>
</div>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<div id="identify-groundwater-gradient-across-lakes" class="section level3">
<h3>1. Identify Groundwater Gradient Across Lakes</h3>
</div>
<div id="summarize-monthly-input-data" class="section level3">
<h3>2. Summarize Monthly Input Data</h3>
<p>Precipitation (mm) and Reference Potential Evapotranspiration (mm) are summed by month and used for the <span class="math inline">\(P\)</span> and <span class="math inline">\(E\)</span> terms. Monthly means are calculated for air temperature (^oC) and relative humidity (%) which are both used to calculate <span class="math inline">\(\delta^{18}O_{E}\)</span>.</p>
<p>Monthly lake surface temperature is calculated by averaging biweekly lake temperature measurements at the surface depth of the vertical profile.</p>
<p>Analysis of <span class="math inline">\(\delta^{18}O\)</span> and <span class="math inline">\(\delta D\)</span> at each well reveal the groundwtaer gradient across each lake. For this anlaysis, the <span class="math inline">\(\delta^{18}O\)</span> of the upgradient groundwater wells were averaged for each month to calculate the <span class="math inline">\(\delta^{18}O_{GW_{in}}\)</span></p>
</div>
<div id="calculate-water-balance" class="section level3">
<h3>3. Calculate Water Balance</h3>
</div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
</div>
<div id="references" class="section level2">
<h2>References</h2>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<p>See below for the versions of R and versions of packages in use when this R Markdown file was created.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">devtools<span class="op">::</span><span class="kw">session_info</span>()</a></code></pre></div>
<pre><code>## - Session info ----------------------------------------------------------
##  setting  value                       
##  version  R version 3.5.0 (2018-04-23)
##  os       Windows 10 x64              
##  system   x86_64, mingw32             
##  ui       RTerm                       
##  language (EN)                        
##  collate  C                           
##  ctype    English_United States.1252  
##  tz       America/Chicago             
##  date     2019-09-06                  
## 
## - Packages --------------------------------------------------------------
##  ! package      * version date       lib source        
##    assertthat     0.2.1   2019-03-21 [1] CRAN (R 3.5.3)
##    backports      1.1.4   2019-04-10 [1] CRAN (R 3.5.3)
##    callr          3.3.1   2019-07-18 [1] CRAN (R 3.5.3)
##    cli            1.1.0   2019-03-19 [1] CRAN (R 3.5.3)
##    commonmark     1.7     2018-12-01 [1] CRAN (R 3.5.3)
##    crayon         1.3.4   2017-09-16 [1] CRAN (R 3.5.3)
##    desc           1.2.0   2018-05-01 [1] CRAN (R 3.5.3)
##    devtools     * 2.1.0   2019-07-06 [1] CRAN (R 3.5.3)
##    digest         0.6.20  2019-07-04 [1] CRAN (R 3.5.3)
##    evaluate       0.14    2019-05-28 [1] CRAN (R 3.5.3)
##    fs             1.3.1   2019-05-06 [1] CRAN (R 3.5.3)
##    glue           1.3.1   2019-03-12 [1] CRAN (R 3.5.3)
##    htmltools      0.3.6   2017-04-28 [1] CRAN (R 3.5.3)
##  P isoH2Obudget * 0.1.0   2019-09-06 [?] local         
##    knitr          1.24    2019-08-08 [1] CRAN (R 3.5.3)
##    lubridate      1.7.4   2018-04-11 [1] CRAN (R 3.5.3)
##    magrittr       1.5     2014-11-22 [1] CRAN (R 3.5.3)
##    memoise        1.1.0   2017-04-21 [1] CRAN (R 3.5.3)
##    pkgbuild       1.0.5   2019-08-26 [1] CRAN (R 3.5.3)
##    pkgload        1.0.2   2018-10-29 [1] CRAN (R 3.5.3)
##    prettyunits    1.0.2   2015-07-13 [1] CRAN (R 3.5.3)
##    processx       3.4.1   2019-07-18 [1] CRAN (R 3.5.3)
##    ps             1.3.0   2018-12-21 [1] CRAN (R 3.5.3)
##    purrr          0.3.2   2019-03-15 [1] CRAN (R 3.5.3)
##    R6             2.4.0   2019-02-14 [1] CRAN (R 3.5.3)
##    Rcpp           1.0.2   2019-07-25 [1] CRAN (R 3.5.3)
##    remotes        2.1.0   2019-06-24 [1] CRAN (R 3.5.3)
##    rlang          0.4.0   2019-06-25 [1] CRAN (R 3.5.3)
##    rmarkdown      1.15    2019-08-21 [1] CRAN (R 3.5.3)
##    roxygen2       6.1.1   2018-11-07 [1] CRAN (R 3.5.3)
##    rprojroot      1.3-2   2018-01-03 [1] CRAN (R 3.5.3)
##    rstudioapi     0.10    2019-03-19 [1] CRAN (R 3.5.3)
##    sessioninfo    1.1.1   2018-11-05 [1] CRAN (R 3.5.3)
##    stringi        1.4.3   2019-03-12 [1] CRAN (R 3.5.3)
##    stringr        1.4.0   2019-02-10 [1] CRAN (R 3.5.3)
##    testthat       2.2.1   2019-07-25 [1] CRAN (R 3.5.3)
##    usethis      * 1.5.1   2019-07-04 [1] CRAN (R 3.5.3)
##    withr          2.1.2   2018-03-15 [1] CRAN (R 3.5.3)
##    xfun           0.9     2019-08-21 [1] CRAN (R 3.5.3)
##    xml2           1.2.2   2019-08-09 [1] CRAN (R 3.5.3)
##    yaml           2.2.0   2018-07-25 [1] CRAN (R 3.5.3)
## 
## [1] C:/Users/votercb/Documents/R/win-library/3.5
## [2] C:/Program Files/R/R-3.5.0/library
## 
##  P -- Loaded and on-disk path mismatch.</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
